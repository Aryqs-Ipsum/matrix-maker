<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>bitmap json font</title>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/balm-ui@next/dist/balm-ui.css" />
    <link rel="stylesheet" href="data/style.css">
</head>

<body>

    <div id="app">

        <div class="demo-container">
            <!-- App bar -->
            <ui-top-app-bar class="demo-app-bar" content-selector=".demo-content" :nav-icon="false">
                kpp dev
                <template #toolbar="{ toolbarItemClass }">
                    <ui-icon-button :class="toolbarItemClass" v-tooltip="'Delete actual destination'" aria-describedby="delete" icon="delete" @click="deleteDest()" v-show="current.code"></ui-icon-button>
                    <ui-icon-button :class="toolbarItemClass" v-tooltip="'Save all destinations in device storage'" aria-describedby="save in storage" icon="save" @click="saveDestsInLocalStorage()"></ui-icon-button>
                    
                    <div class="menu-content">
                        <ui-icon-button :class="toolbarItemClass" icon="get_app" @click="$balmUI.onOpen('downloadMenu')"></ui-icon-button>
                        <ui-menu-anchor absolute>
                            <ui-menu
                            @selected="onSelected"
                            v-model="downloadMenu"
                            :items="[
                                'Current matrix',
                                'Create hof with destinations'
                            ]"
                            ></ui-menu>
                        </ui-menu-anchor>
                    </div>
                </template>
            </ui-top-app-bar>
            <!-- Content -->
            <div class="demo-content">
                <!-- Drawer -->
                <ui-drawer viewport-height>
                    <ui-drawer-header v-show="current.code">
                        <ui-drawer-title>{{ current.name }}</ui-drawer-title>
                        <ui-drawer-subtitle>{{ current.code }}</ui-drawer-subtitle>
                        <canvas width="256" height="64" style="border: solid 1px black;margin-left:-18px;" id="canvas"></canvas>
                    </ui-drawer-header>
                    <ui-drawer-content>
                        <ui-nav>
                            <ui-nav-item id="destsList" v-for="(dest, index) in dests" :key="index" @click="selectCurrent(index)">
                                ({{index}}){{dest.code}}.{{dest.name}}
                            </ui-nav-item>
                            <ui-textfield input-type="number" v-model="addDestCode" v-on:keyup.enter="addDest(addDestCode)">add
                                dest
                            </ui-textfield>
                        </ui-nav>
                    </ui-drawer-content>
                </ui-drawer>
                <!-- App content -->
                <div class="demo-app-content">

                    <!-- Edit current matrix section -->
                    <section v-show="current.code">
                        <ui-textfield v-model="current.code" input-type="number">code</ui-textfield>
                        <ui-textfield v-model="current.name">dest</ui-textfield>

                        <img src="data/overlayImage.png" id="overlayImage" style="display: none;">
                        <canvas width="1024" height="256" style="border: solid 1px black;" id="previewCanvas"></canvas>
                        
                        <!-- Front text -->
                        <hr>
                        <h4>Front text</h4>
                        <ui-textfield v-model="current.front.text" id="frontText" input-type="textarea" rows="2" cols="40" v-on:keyup="writeFrontText()" @change="saveCurrentIntoDests()">front text</ui-textfield>
                        <template v-if="current.front.text">
                            <ui-select v-model="current.front.font" :options="fontList" @change="loadFont(current.front.font)" id="fontSelector">{{ current.front.text.includes('\n') ? 'Top' : 'Main' }} font</ui-select>
                            <ui-select v-model="current.front.fontb" :options="fontList" @change="loadFont(current.front.font)" id="fontSelector" v-show="current.front.text.includes('\n')">Bottom font</ui-select>
                            <div style="position:relative; display:inline-block">
                                <ui-button raised type="button" v-bind:style="{ backgroundColor: current.front.color }">front text color</ui-button raised>
                                <input type="color" v-model="current.front.color" @change="refreshMatrix()" style="opacity:0; position:absolute; left:0;top:0;width:100%"/>
                            </div>
                        </template>

                        <!-- Line -->
                        <hr>
                        <h4>Line text</h4>
                        <ui-textfield v-model="current.line.text" @keyup="writeLineText()">front line number</ui-textfield>
                        <ui-select v-model="current.line.font" :options="fontList" @change="loadFont(current.line.font)" id="fontSelector"></ui-select>
                        <div style="position:relative; display:inline-block">
                            <ui-button raised type="button" v-bind:style="{ backgroundColor: current.line.fore }">line color</ui-button raised>
                            <input type="color" v-model="current.line.fore" @change="refreshMatrix()" style="opacity:0; position:absolute; left:0;top:0;width:100%"/>
                        </div>
                        <div style="position:relative; display:inline-block">
                            <ui-button raised type="button" v-bind:style="{ backgroundColor: current.line.outl }">line outline</ui-button raised>
                            <input type="color" v-model="current.line.outl" @change="refreshMatrix()" style="opacity:0; position:absolute; left:0;top:0;width:100%"/>
                        </div>
                        <div style="position:relative; display:inline-block">
                            <ui-button raised type="button" v-bind:style="{ backgroundColor: current.line.back }">line background</ui-button raised>
                            <input type="color" v-model="current.line.back" @change="refreshMatrix()" style="opacity:0; position:absolute; left:0;top:0;width:100%"/>
                        </div>
                        <ui-form-field>
                            <ui-switch v-model="current.front.line" @change="refreshMatrix()"></ui-switch>
                            <label>Show line on front</label>
                        </ui-form-field>

                        <!-- Side text -->
                        <hr>
                        <h4>Side text</h4>
                        <ui-textfield v-model="current.side.text" @keyup="writeSideText">Side text</ui-textfield>
                        <ui-select v-model="current.side.font" :options="fontList" @change="loadFont(current.side.font)" id="fontSelector"></ui-select>
                        <div style="position:relative; display:inline-block">
                            <ui-button raised type="button" v-bind:style="{ backgroundColor: current.side.color }">side color</ui-button raised>
                            <input type="color" v-model="current.side.color" @change="refreshMatrix()" style="opacity:0; position:absolute; left:0;top:0;width:100%"/>
                        </div>
                        <div style="height: 5rem;"></div>
                    </section>

                    <!-- Empty selection section -->
                    <section v-show="!current.code" style="width: 100%;text-align: center;">
                        <ui-icon style="font-size: 15rem;color: grey;">touch_app</ui-icon>
                        <p>Start by select a destination ou create it in the side nav.</p>
                    </section>

                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/balm-ui@8.0.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/balm-ui@8.0.0/dist/balm-ui-plus.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas2image@1.0.5/canvas2image.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.5.0/jszip.min.js"></script>
    <script src="./data/ascii-table.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jcanvas/21.0.1/min/jcanvas.min.js"></script>
    <script type="text/javascript">
        var _c = new Date().getTime();
        document.write('<script type="text/javascript" src="data/script.js?c='+_c+'"><\/script>');
    </script>

</body>

</html>